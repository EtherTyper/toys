================================================================================
             Iterate over bits of a large bit stream
================================================================================

.. contents::


Introduction
-----------------------------------------------------------

Comparison of four methods:

1. naive method --- test each bit of word, run a procedure if the bit is set;
2. better method --- find the lowest bit set, determine its index and clear it;
3. block-3 -- split a word into 3-bit subwords, for each subword unroll callback calls;
4. block-4 -- as above, but subword size is 4 bits.

In all methods the number of callback call is the same and is equal the number
of bits set in a word.  The methods differ in the number of iterations over
a single word:

1. naive method -- the position of most significant bit set;
2. better method -- the number of bits set;
3. block-3 -- 3 * index of last non-zero block;
4. block-4 -- 4 * index of last non-zero block.


Implementations
-----------------------------------------------------------

Naive method::

    for (size_t i=0; i < n; i++) {
        uint64_t tmp = array[i];

        size_t k = i * 64;
        while (tmp) {
            if (tmp & 0x1) {
                callback(k);
            }

            tmp >>= 1;
            k += 1;
        }
    }

Better method::

    for (size_t i=0; i < n; i++) {
        uint64_t tmp = array[i];

        size_t k = i * 64;
        while (tmp) {
            const uint64_t t = tmp & (~tmp + 1);
            const uint64_t r = __builtin_ctzll(t);
            callback(k + r);
            tmp ^= t;
        }
    }

Block-3 method::

    for (size_t i=0; i < n; i++) {
        uint64_t tmp = array[i];

        size_t k = i * 64;
        while (tmp) {
            
            switch (tmp & 0x7) {
                case 0:
                    break;

                case 1:
                    callback(k);
                    break;

                // inline callback calls for rest values 2..7
            }

            tmp >>= 3;
            k += 3;
        }
    }

Block-4 method::

    for (size_t i=0; i < n; i++) {
        uint64_t tmp = array[i];

        size_t k = i * 64;
        while (tmp) {
            
            switch (tmp & 0xf) {
                case 0:
                    break;

                case 1:
                    callback(k);
                    break;

                // inline callback calls for rest values 2..15
            }

            tmp >>= 4;
            k += 4;
        }
    }

Tests & results
--------------------------------------------------------------------------------

Tests check different vectors sizes (given in bits) and various fill factors.

Below are unprocessed outputs from ``make``. The number in parentheses next
to "better" timing is the speed-up factor.


Core i5 M540 @ 2.53GHz
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| case  | size [bits] | cardinality [bits] | fill factor | naive [us] | better [us] | block-3 [us] | block-4 [us] |
+=======+=============+====================+=============+============+=============+==============+==============+
| empty | 4096        | 0                  | 0.00        | 2,757      | 2,686       | 2,685        | 2,541        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 0                  | 0.00        | 4,077      | 2,674       | 2,658        | 3,536        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 0                  | 0.00        | 13,241     | 10,307      | 10,307       | 21,077       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 0                  | 0.00        | 42,812     | 42,239      | 41,979       | 41,552       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 0                  | 0.00        | 82,209     | 82,154      | 82,478       | 82,127       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 1/4   | 4096        | 1024               | 0.25        | 1,095      | 1,820       | 1,800        | 632          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 4096               | 0.25        | 4,387      | 7,491       | 7,145        | 2,703        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 16384              | 0.25        | 17,856     | 30,184      | 29,293       | 10,090       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 65536              | 0.25        | 70,660     | 113,243     | 114,191      | 40,753       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 131072             | 0.25        | 139,363    | 227,974     | 227,766      | 79,623       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 1/2   | 4096        | 2048               | 0.50        | 2,227      | 3,585       | 2,411        | 1,216        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 8192               | 0.50        | 9,250      | 15,094      | 9,370        | 6,055        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 32768              | 0.50        | 36,529     | 58,447      | 39,301       | 21,569       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 131072             | 0.50        | 144,303    | 230,651     | 153,109      | 79,766       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 262144             | 0.50        | 284,716    | 459,346     | 305,596      | 161,511      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 3/4   | 4096        | 3072               | 0.75        | 3,220      | 5,289       | 2,536        | 1,854        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 12288              | 0.75        | 12,917     | 21,669      | 9,886        | 7,560        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 49152              | 0.75        | 52,425     | 84,515      | 40,059       | 29,181       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 196608             | 0.75        | 207,885    | 338,453     | 165,485      | 115,802      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 393216             | 0.75        | 413,418    | 676,994     | 316,149      | 229,901      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| full  | 4096        | 4096               | 1.00        | 4,132      | 7,198       | 3,616        | 2,772        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 16384              | 1.00        | 17,131     | 28,740      | 15,117       | 11,030       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 65536              | 1.00        | 66,992     | 114,646     | 59,330       | 45,160       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 262144             | 1.00        | 262,853    | 455,859     | 231,925      | 176,150      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 524288             | 1.00        | 540,639    | 910,853     | 461,862      | 351,302      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| rand  | 4096        | 896                | 0.22        | 1,117      | 1,792       | 983          | 751          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 3136               | 0.19        | 3,938      | 6,410       | 3,521        | 2,549        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 14208              | 0.22        | 18,892     | 29,680      | 15,962       | 11,385       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 51904              | 0.20        | 67,221     | 104,382     | 58,606       | 45,026       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 103424             | 0.20        | 130,542    | 207,050     | 118,085      | 84,712       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| rand2 | 4096        | 3968               | 0.97        | 4,033      | 7,235       | 3,198        | 2,397        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 15360              | 0.94        | 16,767     | 27,220      | 13,650       | 9,150        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 61888              | 0.94        | 63,610     | 110,058     | 51,172       | 37,516       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 246400             | 0.94        | 249,307    | 434,637     | 200,026      | 146,489      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 491712             | 0.94        | 496,344    | 866,872     | 398,533      | 291,118      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+

+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| case  | size [bits] | cardinality [bits] | fill factor | naive [x] | better [x] | block-3 [x] | block-4 [x] |
+=======+=============+====================+=============+===========+============+=============+=============+
| empty | 4096        | 0                  | 0.00        | 1.00      | 1.03       | 1.03        | 1.09        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 0                  | 0.00        | 1.00      | 1.52       | 1.53        | 1.15        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 0                  | 0.00        | 1.00      | 1.28       | 1.28        | 0.63        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 0                  | 0.00        | 1.00      | 1.01       | 1.02        | 1.03        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 0                  | 0.00        | 1.00      | 1.00       | 1.00        | 1.00        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 1/4   | 4096        | 1024               | 0.25        | 1.00      | 0.60       | 0.61        | 1.73        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 4096               | 0.25        | 1.00      | 0.59       | 0.61        | 1.62        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 16384              | 0.25        | 1.00      | 0.59       | 0.61        | 1.77        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 65536              | 0.25        | 1.00      | 0.62       | 0.62        | 1.73        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 131072             | 0.25        | 1.00      | 0.61       | 0.61        | 1.75        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 1/2   | 4096        | 2048               | 0.50        | 1.00      | 0.62       | 0.92        | 1.83        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 8192               | 0.50        | 1.00      | 0.61       | 0.99        | 1.53        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 32768              | 0.50        | 1.00      | 0.62       | 0.93        | 1.69        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 131072             | 0.50        | 1.00      | 0.63       | 0.94        | 1.81        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 262144             | 0.50        | 1.00      | 0.62       | 0.93        | 1.76        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 3/4   | 4096        | 3072               | 0.75        | 1.00      | 0.61       | 1.27        | 1.74        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 12288              | 0.75        | 1.00      | 0.60       | 1.31        | 1.71        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 49152              | 0.75        | 1.00      | 0.62       | 1.31        | 1.80        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 196608             | 0.75        | 1.00      | 0.61       | 1.26        | 1.80        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 393216             | 0.75        | 1.00      | 0.61       | 1.31        | 1.80        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| full  | 4096        | 4096               | 1.00        | 1.00      | 0.57       | 1.14        | 1.49        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 16384              | 1.00        | 1.00      | 0.60       | 1.13        | 1.55        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 65536              | 1.00        | 1.00      | 0.58       | 1.13        | 1.48        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 262144             | 1.00        | 1.00      | 0.58       | 1.13        | 1.49        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 524288             | 1.00        | 1.00      | 0.59       | 1.17        | 1.54        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| rand  | 4096        | 896                | 0.22        | 1.00      | 0.62       | 1.14        | 1.49        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 3136               | 0.19        | 1.00      | 0.61       | 1.12        | 1.54        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 14208              | 0.22        | 1.00      | 0.64       | 1.18        | 1.66        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 51904              | 0.20        | 1.00      | 0.64       | 1.15        | 1.49        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 103424             | 0.20        | 1.00      | 0.63       | 1.11        | 1.54        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| rand2 | 4096        | 3968               | 0.97        | 1.00      | 0.56       | 1.26        | 1.68        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 15360              | 0.94        | 1.00      | 0.62       | 1.23        | 1.83        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 61888              | 0.94        | 1.00      | 0.58       | 1.24        | 1.70        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 246400             | 0.94        | 1.00      | 0.57       | 1.25        | 1.70        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 491712             | 0.94        | 1.00      | 0.57       | 1.25        | 1.70        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+

Skylake Core i7-6700 CPU @ 3.40GHz
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| case  | size [bits] | cardinality [bits] | fill factor | naive [us] | better [us] | block-3 [us] | block-4 [us] |
+=======+=============+====================+=============+============+=============+==============+==============+
| empty | 4096        | 0                  | 0.00        | 448        | 489         | 450          | 498          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 0                  | 0.00        | 1,587      | 1,583       | 1,580        | 1,632        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 0                  | 0.00        | 6,117      | 6,116       | 6,112        | 6,162        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 0                  | 0.00        | 29,252     | 24,270      | 24,268       | 24,280       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 0                  | 0.00        | 50,423     | 48,430      | 48,427       | 48,437       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 1/4   | 4096        | 1024               | 0.25        | 607        | 1,095       | 402          | 347          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 4096               | 0.25        | 2,418      | 4,367       | 1,591        | 1,366        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 16384              | 0.25        | 9,670      | 17,457      | 6,348        | 5,442        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 65536              | 0.25        | 38,658     | 69,838      | 25,380       | 21,752       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 131072             | 0.25        | 77,356     | 139,652     | 50,736       | 43,490       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 1/2   | 4096        | 2048               | 0.50        | 1,582      | 2,862       | 723          | 649          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 8192               | 0.50        | 6,297      | 11,429      | 2,874        | 2,577        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 32768              | 0.50        | 25,151     | 45,708      | 11,481       | 10,280       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 131072             | 0.50        | 100,620    | 182,803     | 45,912       | 41,073       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 262144             | 0.50        | 201,222    | 365,616     | 91,927       | 82,145       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| 3/4   | 4096        | 3072               | 0.75        | 2,310      | 4,058       | 968          | 950          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 12288              | 0.75        | 9,228      | 16,214      | 3,856        | 3,782        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 49152              | 0.75        | 36,807     | 64,832      | 15,411       | 15,109       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 196608             | 0.75        | 146,074    | 259,365     | 61,608       | 60,401       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 393216             | 0.75        | 292,654    | 518,745     | 123,206      | 120,799      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| full  | 4096        | 4096               | 1.00        | 2,914      | 5,262       | 1,816        | 1,270        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 16384              | 1.00        | 11,361     | 21,032      | 7,026        | 5,063        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 65536              | 1.00        | 45,701     | 84,240      | 27,987       | 20,239       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 262144             | 1.00        | 182,616    | 335,812     | 111,683      | 80,934       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 524288             | 1.00        | 363,271    | 670,776     | 225,414      | 161,866      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| rand  | 4096        | 896                | 0.22        | 641        | 1,175       | 530          | 324          |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 3136               | 0.19        | 2,278      | 4,092       | 1,959        | 1,236        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 14208              | 0.22        | 11,188     | 19,116      | 9,270        | 6,313        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 51904              | 0.20        | 42,156     | 70,964      | 35,769       | 24,711       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 103424             | 0.20        | 84,643     | 142,184     | 71,724       | 49,749       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
| rand2 | 4096        | 3968               | 0.97        | 2,760      | 5,113       | 1,980        | 1,229        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 16384       | 15360              | 0.94        | 10,711     | 19,638      | 7,863        | 4,794        |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 65536       | 61888              | 0.94        | 43,126     | 79,853      | 31,981       | 19,236       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 262144      | 246400             | 0.94        | 171,870    | 317,508     | 130,359      | 76,709       |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+
|       | 524288      | 491712             | 0.94        | 343,149    | 633,936     | 258,609      | 153,245      |
+-------+-------------+--------------------+-------------+------------+-------------+--------------+--------------+

+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| case  | size [bits] | cardinality [bits] | fill factor | naive [x] | better [x] | block-3 [x] | block-4 [x] |
+=======+=============+====================+=============+===========+============+=============+=============+
| empty | 4096        | 0                  | 0.00        | 1.00      | 0.92       | 1.00        | 0.90        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 0                  | 0.00        | 1.00      | 1.00       | 1.00        | 0.97        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 0                  | 0.00        | 1.00      | 1.00       | 1.00        | 0.99        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 0                  | 0.00        | 1.00      | 1.21       | 1.21        | 1.20        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 0                  | 0.00        | 1.00      | 1.04       | 1.04        | 1.04        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 1/4   | 4096        | 1024               | 0.25        | 1.00      | 0.55       | 1.51        | 1.75        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 4096               | 0.25        | 1.00      | 0.55       | 1.52        | 1.77        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 16384              | 0.25        | 1.00      | 0.55       | 1.52        | 1.78        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 65536              | 0.25        | 1.00      | 0.55       | 1.52        | 1.78        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 131072             | 0.25        | 1.00      | 0.55       | 1.52        | 1.78        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 1/2   | 4096        | 2048               | 0.50        | 1.00      | 0.55       | 2.19        | 2.44        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 8192               | 0.50        | 1.00      | 0.55       | 2.19        | 2.44        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 32768              | 0.50        | 1.00      | 0.55       | 2.19        | 2.45        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 131072             | 0.50        | 1.00      | 0.55       | 2.19        | 2.45        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 262144             | 0.50        | 1.00      | 0.55       | 2.19        | 2.45        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| 3/4   | 4096        | 3072               | 0.75        | 1.00      | 0.57       | 2.39        | 2.43        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 12288              | 0.75        | 1.00      | 0.57       | 2.39        | 2.44        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 49152              | 0.75        | 1.00      | 0.57       | 2.39        | 2.44        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 196608             | 0.75        | 1.00      | 0.56       | 2.37        | 2.42        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 393216             | 0.75        | 1.00      | 0.56       | 2.38        | 2.42        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| full  | 4096        | 4096               | 1.00        | 1.00      | 0.55       | 1.60        | 2.29        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 16384              | 1.00        | 1.00      | 0.54       | 1.62        | 2.24        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 65536              | 1.00        | 1.00      | 0.54       | 1.63        | 2.26        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 262144             | 1.00        | 1.00      | 0.54       | 1.64        | 2.26        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 524288             | 1.00        | 1.00      | 0.54       | 1.61        | 2.24        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| rand  | 4096        | 896                | 0.22        | 1.00      | 0.55       | 1.21        | 1.98        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 3136               | 0.19        | 1.00      | 0.56       | 1.16        | 1.84        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 14208              | 0.22        | 1.00      | 0.59       | 1.21        | 1.77        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 51904              | 0.20        | 1.00      | 0.59       | 1.18        | 1.71        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 103424             | 0.20        | 1.00      | 0.60       | 1.18        | 1.70        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
| rand2 | 4096        | 3968               | 0.97        | 1.00      | 0.54       | 1.39        | 2.25        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 16384       | 15360              | 0.94        | 1.00      | 0.55       | 1.36        | 2.23        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 65536       | 61888              | 0.94        | 1.00      | 0.54       | 1.35        | 2.24        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 262144      | 246400             | 0.94        | 1.00      | 0.54       | 1.32        | 2.24        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+
|       | 524288      | 491712             | 0.94        | 1.00      | 0.54       | 1.33        | 2.24        |
+-------+-------------+--------------------+-------------+-----------+------------+-------------+-------------+

